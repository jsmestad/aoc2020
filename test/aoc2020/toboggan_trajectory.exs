defmodule Aoc2020.TobogganTrajectoryTest do
  use ExUnit.Case

  alias Aoc2020.TobogganTrajectory

  def test_input do
    """
    ..##.......
    #...#...#..
    .#....#..#.
    ..#.#...#.#
    .#...##..#.
    ..#.##.....
    .#.#.#....#
    .#........#
    #.##...#...
    #...##....#
    .#..#...#.#
    """
  end

  def real_input do
    """
    .#.......#...........#.........
    ..##.......#.#.#.....##...#....
    .......#..#.....#...#..........
    ...#..........###...#........##
    #.#..#.#.##.#........#.#.....#.
    #..#....#..#....#..............
    #..#........#..................
    ..#.#...#.#...#....#.#.#..#....
    ..............#..#.............
    .##....#...................#...
    ........#..........#......#...#
    .##..#..#...##..........#...#..
    .#...#....#.........#...#.....#
    .#........##............#.#....
    ...........#..............##...
    .#..#......#..#..............#.
    ..#.#.#...........#........#...
    ..###..........#....#.#......#.
    .......#...##..........#.......
    ........#...#..................
    ....#....#..#.......#........#.
    .......##.#......#.....#...##..
    ..#.#........................#.
    .#.....#.##..............#.#...
    ..#.#...#.#..#....#....#.......
    .#....##.....#....#........#...
    ..#...........#.##....#...#....
    ..#.##...#....#.#.....##...#...
    .......#...####...#...#.......#
    .#...#.........................
    .......................#.......
    .....#.#.........#..........#.#
    #.........#............###..#..
    .....#.#.............###.......
    ...#..#........#.#.......#.....
    ...................#....#......
    ...#..#...#............#..##...
    ...#.....#....#.......##......#
    .....#....#...##..#..#...#...#.
    ..........#...........#.#.#....
    ..#.......#...#.....#......#...
    .........#.......##......#..#.#
    ..#.....#..#.###...#.#......#..
    #....#...#..#...#.....#........
    ..#......#..#.......#.#.....#..
    #......#...#......#.....##.#...
    ........##.......#.......#.....
    .#.#...............#...........
    ..............#...#.#....#.....
    ....#......#.#..#......#.......
    ...##....#....#...#............
    .#...............#...........#.
    .#.#...#.#.....#.....#...#.#...
    ...##...........#.....#..#...#.
    .#.#...##.#.#......#......#....
    .##.....#.......##....#.#.#....
    .......#...........#....#....#.
    ....#...........#......#.####..
    ......#....#...#...##.......#..
    ......................#.#####..
    ..#...#.#...#..#..#......#.....
    ....#........##.......##....#..
    #.#......##.........##.#..#...#
    .#.#....#...#..#...#...##....#.
    .....##...#....#....#.#........
    ......#..#....#.#...#..........
    .........#...................#.
    ............#.###....#.#.......
    ...#.#.....#......#....#.#..#..
    ..............#..#.#.#.#.......
    #..##...................##.....
    ..#.......#..#.........##..#...
    .........##...#......#........#
    ..#.........#........##.###.#..
    ...........#.#....#.....###....
    ..#....##.#..#.##....#.....##..
    ..#.....#.##..................#
    #....#.........................
    ..............#..#...#.#.......
    ......#..#.#.##....#..........#
    ..#.........#.####.....#.......
    ......#..#.#..........#...#....
    ......#.................#..#.#.
    .....#..........#..............
    ....#.....#............#....##.
    .....#.....#........#..........
    ............#.....#...#........
    ........#....#.#...............
    #.....#.........#......#..#.#..
    ...#..#......#......#.......#..
    .....#......#.#....#..#...#...#
    ......................#..##....
    .............#.........###....#
    #..............#.#..........##.
    ...#.#.................##......
    ...........#.#.....#...........
    .........#.................#.#.
    ........#........#...#..##...#.
    ........#......##.......###....
    ..............#.#.#............
    .#.....###...##.#......#.....#.
    .............#......#.#.#...#.#
    ..#.........#.......#.....#....
    ......#........#...##......#...
    .##..........##......#.#.....#.
    ..#.##....#....#...............
    ......#...#..#.....#.....#...#.
    .......##..##..#............##.
    ..............#...##........#..
    #....#................#..#.....
    ........#.......#.#.#...#......
    ......#.......#..............#.
    #.#..#...#........#....#..####.
    ..#........#...........#.....#.
    .##...........................#
    .............#...........#.....
    .#.....#.#...#.........#.......
    ..........#...#....#....#......
    .#..#........##....#...........
    .......###......##...#.........
    ..........#.#.#..#.#....#......
    ........##..#.........#....#...
    ........#.#......#.#...#.#..#..
    ....#....................#.##..
    ##....#..#...........#.....#.#.
    ...#..............##...##..#.#.
    ......#.##.#.......#..#...#....
    ....#..#..##.....#.....#.#....#
    .......#....##.##..............
    #..##....#.....#.#.............
    ..................#......#..#..
    ..#......#...#..#.......#...#..
    ...........#....#.#.....#......
    #..#...##.........###..#......#
    .......#......................#
    #.......#....................#.
    ..#..#..........#..#..#....#...
    .##..#..#.....#.#..##..........
    #..###.......#..##..#...#..#.#.
    .....##......###.....#.#.##...#
    ..............#...#....#.#.....
    #...........#..................
    ..............#....#..##..#..#.
    .........#.............#.......
    .#.#....#....#...............##
    .##.##.#.....###.....#.........
    ....#..............##......#...
    ....#........##................
    ....#.....#....#....##....##...
    .#........#......#......#......
    ....#..........#...............
    ##..........#......#.....#.....
    ........#.#..#.#..#.....##.....
    ..##......#.#.......#.#..#.....
    .#.......#......#...........#..
    ..#.#..#.#..................#..
    ...#...#...#...##......#.......
    .#...##....#...#...#...#.......
    .......#.#.......#.............
    .#.##.#.....#...........#.##.#.
    .#.##.#........#...##..........
    .#.....#.....#....#..#.........
    ...##.............##...........
    .#........##.....#.......#...#.
    ...........#..#..##........##..
    .....#..#......................
    ..#.......#....................
    .....#......#....#....#.......#
    ........#..#.#.....#......#....
    ..........#..#.....#......#....
    ..........#####.....#........#.
    ........#..#...#.#....#......#.
    .........#...#....#.#..........
    ......#....##..........#...#...
    #..............###.#.#.........
    .#.#............##......#.#..#.
    ......#........................
    ...#..#......#.......#....#...#
    .......#....##.....#.#......##.
    ...........#..........#..#.....
    ...........#..#.....###......#.
    .......#....#..##......#.......
    .........#.#.#.......#..#...#..
    .......#.......##.....##...#...
    ..............#....#.....#.....
    ...#....#.....#.#..........##..
    ###.........#.............#....
    ...##......#.#........#....#..#
    #....###.......#...#.#......##.
    ....#...##.......#......#.....#
    .....#......#..................
    #........##....#....#.#........
    ........#.......###...#........
    ........#..#.......###.........
    ..............#......#..#......
    #......#.....#....#.#..........
    .#......##.#.#.....#...#.#....#
    .##...........#..#.##.....#....
    .....#.....................#...
    .#..#...#...##.#...#...........
    .......#.......##..#.#..#......
    .......##.....#.....#..........
    .................#.............
    #........#..#.......##.........
    #...#..###.#..#....#.#.###.....
    ..#.......#.......#.......#....
    ..............#............##..
    .#...#..#...##.........#....#..
    #...........#...#..............
    .......#.....#......#..#.....#.
    ..........#......#.............
    ##.........###..##.#....#..#.#.
    ..............###..............
    #..##.............##.....#.....
    ....##...................#..#..
    ....#.....#..............#..#.#
    ........#........##...#.....##.
    #...........#.##..........##...
    #......##.....#...............#
    ..##..#....#.................#.
    #.......##.....................
    ...............#.##..##......#.
    ..#.##..#.#....#.......##......
    ......##....#............##....
    .#..#..##.....#.##....#........
    #.........#..........#...#....#
    ...#.......#.............#.#.#.
    ..##............#...##........#
    .......#.#.#........#..........
    .....#.............#.....#.....
    .........#.........#.........#.
    #.....#....#.......#...........
    .........#....#.............#.#
    .##..#.......#...#......#......
    ....#....#....#........#....#..
    ............#.......#..#......#
    .#............#.##........##...
    ..#...##...#....#...#.#...#..#.
    #...#..........#..##.........#.
    ..#.........................#.#
    ...........#.........#..#.##...
    .#..................#..#.......
    ......#......#...........#..#..
    ...##.....#.....#..#.......#...
    .........#.#.......#......#....
    ...........#................#..
    .....#...#..#............##....
    .#.......#..#....#..........#..
    #.....#..#.....#..##.......##..
    ...#.......#...#....#...#.#..##
    ...#...##......#....#....#.....
    .......###.#..#.......#......#.
    ........#.#...#..#..#...#....#.
    ....#.........##.#.....#.......
    ....#.........#..##........#...
    ..#...........#......#....#.##.
    .....................#.........
    ...................##......#..#
    ......#.#.....##..##..........#
    ..#.##........#.#.#..........#.
    .#.......#...##.#....#....#....
    #.#......#..#..#.......#.......
    .............#........#.......#
    ....#...#.....#........#...#...
    ..#..............##..#.........
    ..#.................#..#...##..
    ....#..#...#...................
    ......#.........##.#..#..#...##
    ........#..#....#.......#.#.##.
    .#...#...........#..........#..
    ##.....#...#............##...#.
    .##.....#...#..................
    .#.......####.#..##.##.#......#
    .............#...#..#..#.......
    ...#.##.........#.#....#.......
    ...........##...##....#....##..
    ........#......#...#...........
    ...........#..#...#....#.##....
    ..##....#..........#....#...#..
    #....#.#.#.......#.#...........
    ......#............##..........
    #.#.###..#....#.......#...#....
    .#......##..#..#.#.........#..#
    ..#.........#........#....#....
    ......##.#.......##....#..#..##
    .............#...#............#
    ......#......#...#.#.#.##.#....
    #.#...#.##.....#..............#
    ..........#.............##.##..
    #......#....#...#.#.#.#..#....#
    ........#........#...#.#......#
    .....#...........#.............
    ...........#....#..........#...
    ....####...#..##....#.#........
    .#......#...#..#...........#...
    #......###..#.##.###...........
    ..#...........#.........#....#.
    ................#.#....#..#.##.
    ...................#......#....
    ....#.#.....#.......#...###.##.
    .#........#.#....#...#..#...#..
    ....#..###.................#..#
    .....#.#..#........#......#..#.
    ....#.....#...............#...#
    ............##.#.........#..#..
    .......#..#..##.#.#...##.......
    ..#..........##..#..#........#.
    ..............#..#...#.........
    ......#.#....#........##.......
    .#.....##....#..#...#.......##.
    ..............#.##.............
    #..#..#...##....##.#.....##.#..
    ..#...###..#.........##........
    ........##......#.....#..###...
    .....#......##.###.............
    ....#.....#.#..#.#..#..........
    ....#..#.......#...........#...
    .#.............#..#......##....
    ..#.#......#.#.................
    .......#.#.#............#..#...
    ......###....##............#..#
    .........#....#......#.........
    ..........#...............#..#.
    """
  end

  test "part_one/1" do
    assert test_input() |> TobogganTrajectory.part_one() == 7
    assert real_input() |> TobogganTrajectory.part_one() == 209
  end

  test "part_two/1" do
    assert test_input() |> TobogganTrajectory.part_two() == 336
    assert real_input() |> TobogganTrajectory.part_two() == 1_574_890_240
  end
end
